<beast version='2.0'
       namespace='beast.core:beast.core.parameter:beast.core.util:beast.math.distributions:beast.evolution.tree.coalescent:beast.util:beast.evolution.operators:timsaddons.modelselection'>

   <tree spec='TreeParser' id='tree' IsLabelledNewick='true'>
     <input name='newick'>
((((((((((t1:0.025599197575178197,t16:0.025599197575178197):0.035413923316976195,t83:0.06101312089215439):0.030800218682061585,t12:0.09181333957421597):0.007823125206374681,t87:0.09963646478059066):0.20431975035041558,t15:0.30395621513100624):0.8396389949795344,(((t6:0.13333221596471193,(t22:0.012344460761210983,(t74:0.008619305619463816,t97:0.008619305619463816):0.003725155141747167):0.12098775520350094):0.57989863286512,((((t7:0.1631834700896121,t42:0.1631834700896121):0.06060374360423196,(t62:0.039504478911969246,t79:0.039504478911969246):0.1842827347818748):0.04470310601279312,(t52:0.12456666591023821,(t71:0.0066915816727515,t98:0.0066915816727515):0.11787508423748672):0.14392365379639896):0.06982407834227178,(((t8:0.035857501388394324,t44:0.035857501388394324):0.020229620212929247,t69:0.05608712160132357):0.03670957909866474,t43:0.09279670069998831):0.24551769734892065):0.37491645078092295):0.15474785121379742,t51:0.8679787000436293):0.27561651006691135):0.4423438638280943,(((((t3:0.2839648225081922,((t20:0.02526809141627342,t64:0.02526809141627342):0.08691548560325256,t93:0.11218357701952598):0.17178124548866625):0.19735111997052412,((t31:0.15045703423297724,t50:0.15045703423297724):0.016034516804044607,t91:0.16649155103702185):0.3148243914416945):0.07366365793724738,t28:0.5549796004159637):0.48171398544354815,((t40:0.12971204521207058,(t58:0.08323624810160096,t77:0.08323624810160096):0.04647579711046962):0.03563967767324236,t47:0.16535172288531294):0.8713418629741989):0.08376220531930012,(t10:0.09507020764464164,t88:0.09507020764464164):1.0253855835341703):0.465483282759823):0.2318995364513039,((((t13:0.026004824924498602,t66:0.026004824924498602):0.30194246855518686,(t73:0.31756308359602214,((t35:0.0025345006791168017,t68:0.0025345006791168017):0.21535187139010445,(t89:0.06531845762889364,t94:0.06531845762889364):0.15256791444032763):0.09967671152680088):0.010384209883663342):0.15041537823073003,((t23:0.11055500429930862,t30:0.11055500429930862):0.2947677310434297,t84:0.40532273534273827):0.07303993636767725):1.201042134770215,t14:1.6794048064806304):0.13843380390930848):0.38185507038040023,((((t4:0.016837891758451233,t96:0.016837891758451233):0.013050774433787098,(t27:0.008296624597274675,(t59:0.0039109322669697395,t95:0.0039109322669697395):0.004385692330304935):0.021592041594963654):0.24261581724897124,t70:0.2725044834412096):1.2242140556925336,((((t11:0.03360362479912351,(t60:0.027568841602744382,t78:0.027568841602744382):0.006034783196379127):0.1786574210113112,t75:0.21226104581043473):0.5393892110452432,t100:0.7516502568556779):0.24150368276110357,(t21:0.4878350833715598,t33:0.4878350833715598):0.5053188562452217):0.5035645995169618):0.7029751416365959):1.875108703662105,((((((((t2:0.05110906712267231,t85:0.05110906712267231):0.06318424414375653,(t29:0.011465312244509881,t41:0.011465312244509881):0.10282799902191897):0.09296374927726052,(t9:0.025623327391067853,(t55:6.841747288123839E-4,t99:6.841747288123839E-4):0.02493915266225547):0.18163373315262152):0.027205512081324545,(t24:0.18176301952813542,(t36:0.09783700557165415,t57:0.09783700557165415):0.08392601395648128):0.05269955309687849):0.5135979705218288,(((t5:0.09034655817154884,t39:0.09034655817154884):0.03793539638717523,t65:0.12828195455872407):0.22121367312860887,(t53:0.10250544590751064,t92:0.10250544590751064):0.2469901817798223):0.3985649154595097):0.6254051898995768,((((t17:0.46881497611848244,t80:0.46881497611848244):0.23327593456361706,(t46:0.04602140677296402,t76:0.04602140677296402):0.6560695039091354):0.34665380584211125,t37:1.0487447165242108):0.2614514975507636,(((((t19:0.04115915481778696,(t54:0.025160122139130596,t72:0.025160122139130596):0.015999032678656364):0.25745892380425517,t49:0.29861807862204215):0.022370509206616818,t86:0.32098858782865897):0.3999355556171413,t63:0.7209241434458002):0.4770938331660357,(t67:0.04899736308472253,t82:0.04899736308472253):1.1490206135271135):0.11217823746313837):0.06326951897144517):0.8456558425936431,((t25:0.4733548395731387,(t38:0.4092575034165475,t56:0.4092575034165475):0.06409733615659119):0.8498709163202172,(t45:0.49951956282244464,t61:0.49951956282244464):0.8237061930709111):0.8958958197467068):0.5041618024927601,((((t18:0.022566121713798477,t48:0.022566121713798477):0.0063124105307805,(t26:0.0015602804421159875,t81:0.0015602804421159875):0.02731825180246299):0.20958487269886783,t90:0.2384634049434468):0.2512301822121964,(t32:0.22817710878735736,t34:0.22817710878735736):0.26151647836828584):2.2335897909771796):1.3515190062996214);
    </input>
  </tree>

  <!-- Population model specifier -->
  <input spec='IntegerParameter' id='modelNumber' value='0'/>

  <!-- Constant population model parameters -->
  <input spec='RealParameter' id='constPopSize' lower='0.0' value='8.0'/>

  <!-- Exponential growth population model parameters -->
  <input spec='RealParameter' id='expPopSize' lower='0.0' value='10.0'/>
  <input spec='RealParameter' id='expGrowthRate' lower='0.0' value='0.5'/>

  <!-- Posterior distribution to sample from -->
  <posterior spec='DistributionSwitcher' id='posterior' modelNumber='@modelNumber'>

    <!-- Constant population model posterior -->
    <distribution spec='CompoundDistribution' id='constPosterior'>
      <distribution spec='beast.math.distributions.Prior' x='@constPopSize'>
	<distr spec='OneOnX'/>
      </distribution>
      <distribution spec='Coalescent'>
	<populationModel spec='ConstantPopulation' popSize='@constPopSize'/>
	<treeIntervals spec='TreeIntervals' tree='@tree'/>
      </distribution>
    </distribution>

    <!-- Exponential growth posterior -->
    <distribution spec='CompoundDistribution' id='expPosterior'>
      <distribution spec='beast.math.distributions.Prior' x='@expPopSize'>
	<distr spec='OneOnX'/>
      </distribution>
      <distribution spec='beast.math.distributions.Prior' x='@expGrowthRate'>
	<distr spec='OneOnX'/>
      </distribution>
      <distribution spec='Coalescent'>
	<populationModel spec='ExponentialGrowth' popSize='@expPopSize' growthRate='@expGrowthRate'/>
	<treeIntervals spec='TreeIntervals' tree='@tree'/>
      </distribution>
    </distribution>
    
  </posterior>

  <run spec='MCMC' id='mcmc' chainLength='1000000'>

    <state>
      <stateNode idref='modelNumber'/>
      <stateNode idref='constPopSize'/>
      <stateNode idref='expPopSize'/>
      <stateNode idref='expGrowthRate'/>
    </state>

    <distribution idref='posterior'/>

    <operator spec='ConditionalScaleOperator' weight='1' id='condScaler'>
      <modelNumber idref='modelNumber'/>

      <parameter idref='constPopSize'/>
      <parameter idref='expPopSize'/>
      <parameter idref='expGrowthRate'/>

      <parameterModelIndices spec="IntegerParameter" value="0 1 1"/>
      <scaleFactors spec="RealParameter" value='0.5'/>
    </operator>

    <operator spec='UniformOperator' parameter='@modelNumber' weight='1' id='modelSwitcher'/>

    <logger logEvery='1000' fileName='modelchoice.log'>
      <model idref='posterior'/>
      <log idref='posterior'/>
      <log idref='modelNumber'/>
      <log idref='constPopSize'/>
      <log idref='expPopSize'/>
      <log idref='expGrowthRate'/>
    </logger>
    <logger logEvery='10000'>
      <model idref='posterior'/>
      <log idref='constPosterior'/>
      <log idref='expPosterior'/>
      <log idref='modelNumber'/>
      <log idref='constPopSize'/>
      <log idref='expPopSize'/>
      <log idref='expGrowthRate'/>
      <ESS spec='ESS' name='log' arg='@constPosterior'/>
    </logger>
  </run>

</beast>
